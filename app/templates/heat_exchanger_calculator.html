{% extends "base.html" %}

{% block title %}Heat Exchanger Calculator - ThermalSim Suite{% endblock %}

{% block content %}
    <h2>Parallel/Counter-Flow Heat Exchanger Calculator</h2>

    <form id="heatExchangerForm">
        <fieldset>
            <legend>Hot Fluid Properties</legend>
            <div>
                <label for="m_dot_hot">Mass Flow Rate (ṁ_hot) [kg/s]:</label>
                <input type="number" id="m_dot_hot" name="m_dot_hot" step="any" required>
            </div>
            <div>
                <label for="Cp_hot">Specific Heat (Cp_hot) [J/kgK]:</label>
                <input type="number" id="Cp_hot" name="Cp_hot" step="any" required>
            </div>
            <div>
                <label for="T_in_hot">Inlet Temperature (T_in_hot) [K]:</label>
                <input type="number" id="T_in_hot" name="T_in_hot" step="any" required>
            </div>
        </fieldset>

        <fieldset>
            <legend>Cold Fluid Properties</legend>
            <div>
                <label for="m_dot_cold">Mass Flow Rate (ṁ_cold) [kg/s]:</label>
                <input type="number" id="m_dot_cold" name="m_dot_cold" step="any" required>
            </div>
            <div>
                <label for="Cp_cold">Specific Heat (Cp_cold) [J/kgK]:</label>
                <input type="number" id="Cp_cold" name="Cp_cold" step="any" required>
            </div>
            <div>
                <label for="T_in_cold">Inlet Temperature (T_in_cold) [K]:</label>
                <input type="number" id="T_in_cold" name="T_in_cold" step="any" required>
            </div>
        </fieldset>

        <fieldset>
            <legend>Heat Exchanger Parameters</legend>
            <div>
                <label for="UA">Overall Heat Transfer Coefficient-Area (UA) [W/K]:</label>
                <input type="number" id="UA" name="UA" step="any" required>
            </div>
            <div>
                <label for="flow_type">Flow Type:</label>
                <select id="flow_type" name="flow_type">
                    <option value="parallel">Parallel Flow</option>
                    <option value="counterflow">Counter Flow</option>
                </select>
            </div>
        </fieldset>

        <button type="submit">Calculate Performance</button>
    </form>

    <div id="results-section" style="margin-top: 20px;">
        <h2>Results</h2>
        <div><strong>NTU:</strong> <span id="NTU_result">---</span></div>
        <div><strong>Effectiveness (ε):</strong> <span id="effectiveness_result">---</span></div>
        <div><strong>Actual Heat Transfer Rate (q_actual) [W]:</strong> <span id="q_actual_result">---</span></div>
        <div><strong>Hot Fluid Outlet Temperature (T_out_hot) [K]:</strong> <span id="T_out_hot_result">---</span></div>
        <div><strong>Cold Fluid Outlet Temperature (T_out_cold) [K]:</strong> <span id="T_out_cold_result">---</span></div>
    </div>

    <div id="resultsActionsHE" style="margin-top: 20px; text-align: center;">
        <button type="button" id="exportPdfBtnHE" style="display: none;">Export Results to PDF</button>
    </div>

    <div id="errorMessages" style="color: red; margin-top: 10px; font-weight: bold;"></div>

    <script src="{{ url_for('static', filename='js/heat_exchanger_calculator.js') }}"></script>
{% endblock %}
